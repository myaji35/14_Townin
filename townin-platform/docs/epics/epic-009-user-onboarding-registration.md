# Epic 009: User Onboarding & Registration

## Epic Overview

**Epic ID**: USR-001
**Title**: User Onboarding & Registration
**Priority**: P0 (Critical)
**Status**: ğŸ“‹ Planned
**Estimated Effort**: 5 days
**Phase**: Phase 1 - User App

## Business Value

ì¼ë°˜ ì‚¬ìš©ìê°€ Townin í”Œë«í¼ì— ì‰½ê³  ë¹ ë¥´ê²Œ ê°€ì…í•˜ê³ , ê°œì¸ í”„ë¡œí•„ì„ ì„¤ì •í•  ìˆ˜ ìˆë„ë¡ ì§ê´€ì ì¸ ì˜¨ë³´ë”© í”Œë¡œìš°ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì†Œì…œ ë¡œê·¸ì¸ì„ í†µí•œ ê°„í¸ ê°€ì…ìœ¼ë¡œ ì§„ì… ì¥ë²½ì„ ë‚®ì¶”ê³ , ì´ˆê¸° ì„¤ì • ë‹¨ê³„ì—ì„œ ì‚¬ìš©ì ë‹ˆì¦ˆë¥¼ íŒŒì•…í•˜ì—¬ ê°œì¸í™”ëœ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

### Target Users
- **New Users**: Towninì„ ì²˜ìŒ ì‚¬ìš©í•˜ëŠ” ì¼ë°˜ ì‹œë¯¼
- **Existing Social Users**: ì¹´ì¹´ì˜¤/ë„¤ì´ë²„/êµ¬ê¸€ ê³„ì • ë³´ìœ ì

### Success Metrics
- íšŒì›ê°€ì… ì™„ë£Œìœ¨ > 70%
- ì†Œì…œ ë¡œê·¸ì¸ ì „í™˜ìœ¨ > 80%
- ì˜¨ë³´ë”© ì™„ë£Œ ì‹œê°„ < 3ë¶„
- í”„ë¡œí•„ ì™„ì„±ë„ > 85%
- 7ì¼ retention rate > 40%

## Epic Scope

### In Scope
1. âœ… ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ íšŒì›ê°€ì… (User ì—­í• )
2. âœ… ì†Œì…œ ë¡œê·¸ì¸ (ì¹´ì¹´ì˜¤/ë„¤ì´ë²„/êµ¬ê¸€)
3. âœ… ì˜¨ë³´ë”© í”Œë¡œìš° (5ë‹¨ê³„)
   - Welcome í™”ë©´
   - ì—­í•  ì„ íƒ (ì¼ë°˜ì‚¬ìš©ì í™•ì¸)
   - ê°œì¸ì •ë³´ ì…ë ¥ (ì´ë¦„, ìƒë…„ì›”ì¼, ì„±ë³„)
   - ê´€ì‹¬ ì¹´í…Œê³ ë¦¬ ì„ íƒ
   - ì•Œë¦¼ ì„¤ì •
4. âœ… í”„ë¡œí•„ ì„¤ì • ë° ìˆ˜ì •
5. âœ… ì´ë©”ì¼ ì¸ì¦
6. âœ… ì•½ê´€ ë™ì˜

### Out of Scope
- âŒ 3-Hub ìœ„ì¹˜ ì„¤ì • (ë³„ë„ Epic USR-002)
- âŒ ìƒì¸ íšŒì›ê°€ì… (ë³„ë„ Epic MRC-001)
- âŒ í”„ë¡œí•„ ì‚¬ì§„ ì—…ë¡œë“œ (Phase 2)
- âŒ ì¹œêµ¬ ì¶”ì²œ ê¸°ëŠ¥

## User Stories

### Story 9.1: Welcome & Role Selection
**As a** new user
**I want to** see a welcoming introduction
**So that** I understand what Townin offers

**Acceptance Criteria**:
- [ ] Welcome ìŠ¤í”Œë˜ì‹œ í™”ë©´
- [ ] Townin ì†Œê°œ (3-4 ìŠ¬ë¼ì´ë“œ)
- [ ] ì—­í•  ì„ íƒ (ì¼ë°˜ì‚¬ìš©ì/ìƒì¸)
- [ ] Skip ë²„íŠ¼

**Tasks**:
- [ ] Frontend: Welcome screen component
- [ ] Frontend: Intro carousel (3 slides)
- [ ] Frontend: Role selection UI
- [ ] Assets: Intro images/illustrations

**Story Points**: 2
**Status**: ğŸ“‹ Planned

---

### Story 9.2: Email/Password Registration
**As a** new user
**I want to** register with email and password
**So that** I can create my account

**Acceptance Criteria**:
- [ ] ì´ë©”ì¼ ì…ë ¥ ë° ê²€ì¦
- [ ] ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ (8ì ì´ìƒ, ì˜ë¬¸+ìˆ«ì)
- [ ] ë¹„ë°€ë²ˆí˜¸ í™•ì¸
- [ ] ì¤‘ë³µ ì´ë©”ì¼ ì²´í¬ (ì‹¤ì‹œê°„)
- [ ] ì¸ì¦ ì´ë©”ì¼ ë°œì†¡
- [ ] ì—­í•  ìë™ ì„¤ì • (User)

**Tasks**:
- [ ] Frontend: Registration form
- [ ] Frontend: Form validation
- [ ] Frontend: Real-time email check
- [ ] Backend: POST /auth/register (ì¬ì‚¬ìš©)
- [ ] Backend: Send verification email

**Story Points**: 3
**Status**: ğŸ“‹ Planned

---

### Story 9.3: Social Login Integration
**As a** new user
**I want to** sign up with Kakao/Naver/Google
**So that** I don't need to remember another password

**Acceptance Criteria**:
- [ ] ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ë²„íŠ¼
- [ ] ë„¤ì´ë²„ ë¡œê·¸ì¸ ë²„íŠ¼
- [ ] êµ¬ê¸€ ë¡œê·¸ì¸ ë²„íŠ¼
- [ ] ìë™ í”„ë¡œí•„ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
- [ ] ìë™ íšŒì›ê°€ì… (ì²« ë¡œê·¸ì¸ ì‹œ)
- [ ] ì•½ê´€ ë™ì˜ í™”ë©´ (ì†Œì…œ ë¡œê·¸ì¸ ì‹œ)

**Tasks**:
- [ ] Frontend: Social login buttons
- [ ] Frontend: OAuth callback handling
- [ ] Backend: Social auth (ì¬ì‚¬ìš© CORE-001)
- [ ] Backend: Auto-create user profile

**Story Points**: 3
**Status**: ğŸ“‹ Planned

---

### Story 9.4: Personal Information Input
**As a** new user
**I want to** enter my basic information
**So that** Townin can personalize services

**Acceptance Criteria**:
- [ ] ì´ë¦„ ì…ë ¥ (ì„ íƒ)
- [ ] ìƒë…„ì›”ì¼ ì…ë ¥ (ì„ íƒ)
- [ ] ì„±ë³„ ì„ íƒ (ì„ íƒ)
- [ ] Skip ê°€ëŠ¥
- [ ] í”„ë¡œí•„ ì €ì¥

**Tasks**:
- [ ] Frontend: Personal info form
- [ ] Frontend: Date picker (birthdate)
- [ ] Frontend: Gender selection
- [ ] Backend: PATCH /users/:id/profile
- [ ] Migration: Add profile fields to users

**Story Points**: 2
**Status**: ğŸ“‹ Planned

---

### Story 9.5: Interest Category Selection
**As a** new user
**I want to** select my interest categories
**So that** I receive relevant flyer recommendations

**Acceptance Criteria**:
- [ ] ì¹´í…Œê³ ë¦¬ ëª©ë¡ í‘œì‹œ (8-10ê°œ)
  - ìŒì‹/ì™¸ì‹, ì‡¼í•‘, ê±´ê°•/ë·°í‹°, êµìœ¡, ì„œë¹„ìŠ¤, ì—¬ê°€/ë¬¸í™” ë“±
- [ ] ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥ (ìµœì†Œ 1ê°œ)
- [ ] ì„ íƒ í•­ëª© ì‹œê°ì  í‘œì‹œ
- [ ] ì €ì¥ ë° ë‹¤ìŒ ë‹¨ê³„

**Tasks**:
- [ ] Frontend: Category selection UI
- [ ] Frontend: Multi-select logic
- [ ] Backend: User interests table
- [ ] Backend: POST /users/:id/interests
- [ ] Migration: user_interests table

**Story Points**: 2
**Status**: ğŸ“‹ Planned

---

### Story 9.6: Notification Preferences
**As a** new user
**I want to** set my notification preferences
**So that** I only receive alerts I want

**Acceptance Criteria**:
- [ ] í‘¸ì‹œ ì•Œë¦¼ ê¶Œí•œ ìš”ì²­
- [ ] ì•Œë¦¼ íƒ€ì…ë³„ ì„¤ì •
  - ìƒˆ ì „ë‹¨ì§€ ì•Œë¦¼
  - í¬ì¸íŠ¸ ì ë¦½ ì•Œë¦¼
  - ë§ˆì¼€íŒ… ì•Œë¦¼
- [ ] ì•Œë¦¼ ì‹œê°„ëŒ€ ì„¤ì • (ì„ íƒ)
- [ ] ì €ì¥ ë° ì˜¨ë³´ë”© ì™„ë£Œ

**Tasks**:
- [ ] Frontend: Notification preferences UI
- [ ] Frontend: Push permission request
- [ ] Backend: User notification settings
- [ ] Backend: PATCH /users/:id/notifications
- [ ] Migration: Add notification_settings to users

**Story Points**: 3
**Status**: ğŸ“‹ Planned

---

### Story 9.7: Terms & Conditions Agreement
**As a** new user
**I want to** review and agree to terms
**So that** I comply with legal requirements

**Acceptance Criteria**:
- [ ] ì•½ê´€ ëª©ë¡
  - ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€ (í•„ìˆ˜)
  - ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ (í•„ìˆ˜)
  - ìœ„ì¹˜ì •ë³´ ì´ìš©ì•½ê´€ (í•„ìˆ˜)
  - ë§ˆì¼€íŒ… ì •ë³´ ìˆ˜ì‹  (ì„ íƒ)
- [ ] ì „ì²´ ë™ì˜ ì²´í¬ë°•ìŠ¤
- [ ] ê°œë³„ ì•½ê´€ ìƒì„¸ ë³´ê¸°
- [ ] í•„ìˆ˜ ì•½ê´€ ë¯¸ë™ì˜ ì‹œ ì§„í–‰ ë¶ˆê°€

**Tasks**:
- [ ] Frontend: Terms agreement UI
- [ ] Frontend: Terms detail modal
- [ ] Frontend: All-agree checkbox logic
- [ ] Backend: User agreements table
- [ ] Backend: POST /users/:id/agreements
- [ ] Legal: Terms content creation

**Story Points**: 3
**Status**: ğŸ“‹ Planned

---

### Story 9.8: User Profile Management
**As a** registered user
**I want to** view and edit my profile
**So that** I can keep my information up to date

**Acceptance Criteria**:
- [ ] í”„ë¡œí•„ ì¡°íšŒ í™”ë©´
- [ ] í”„ë¡œí•„ ìˆ˜ì • í™”ë©´
- [ ] ì´ë©”ì¼ ë³€ê²½ (ì¬ì¸ì¦ í•„ìš”)
- [ ] ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
- [ ] ê´€ì‹¬ ì¹´í…Œê³ ë¦¬ ìˆ˜ì •
- [ ] ì•Œë¦¼ ì„¤ì • ìˆ˜ì •
- [ ] ê³„ì • íƒˆí‡´

**Tasks**:
- [ ] Frontend: Profile view screen
- [ ] Frontend: Profile edit screen
- [ ] Backend: GET /users/me
- [ ] Backend: PATCH /users/me
- [ ] Backend: DELETE /users/me (soft delete)

**Story Points**: 4
**Status**: ğŸ“‹ Planned

---

## Technical Specifications

### Onboarding Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Splash Screen                  â”‚
â”‚      "Welcome to Townin OS"                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Intro Carousel (3 slides)              â”‚
â”‚  1. "ê´‘ê³  ì—†ëŠ” í´ë¦°í•œ ìƒì¡´ ì§€ë„"                â”‚
â”‚  2. "ë¬´ë£Œ ë””ì§€í„¸ ì „ë‹¨ì§€"                        â”‚
â”‚  3. "í•˜ì´í¼ë¡œì»¬ ìƒí™œ OS"                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Role Selection                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ ì¼ë°˜ì‚¬ìš©ì â”‚      â”‚   ìƒì¸    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
           (User ì„ íƒì‹œ)
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Sign Up / Login                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ íšŒì›ê°€ì…               â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  [ì¹´ì¹´ì˜¤]  [ë„¤ì´ë²„]  [êµ¬ê¸€]           â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Terms & Conditions Agreement             â”‚
â”‚  â˜‘ ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€ (í•„ìˆ˜)                       â”‚
â”‚  â˜‘ ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ (í•„ìˆ˜)                     â”‚
â”‚  â˜‘ ìœ„ì¹˜ì •ë³´ ì´ìš©ì•½ê´€ (í•„ìˆ˜)                     â”‚
â”‚  â˜ ë§ˆì¼€íŒ… ì •ë³´ ìˆ˜ì‹  (ì„ íƒ)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Personal Information (Optional)           â”‚
â”‚  ì´ë¦„: [____________]                          â”‚
â”‚  ìƒë…„ì›”ì¼: [____-__-__]                        â”‚
â”‚  ì„±ë³„: â—‹ ë‚¨ì„±  â—‹ ì—¬ì„±  â—‹ ì„ íƒì•ˆí•¨              â”‚
â”‚                            [Skip]  [Next]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Interest Category Selection              â”‚
â”‚  â˜‘ ìŒì‹/ì™¸ì‹    â˜‘ ì‡¼í•‘    â˜ ê±´ê°•/ë·°í‹°         â”‚
â”‚  â˜ êµìœ¡        â˜‘ ì„œë¹„ìŠ¤   â˜ ì—¬ê°€/ë¬¸í™”          â”‚
â”‚  â˜ ìƒí™œìš©í’ˆ     â˜ ê¸°íƒ€                         â”‚
â”‚                            [Skip]  [Next]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Notification Preferences                 â”‚
â”‚  â˜‘ ìƒˆ ì „ë‹¨ì§€ ì•Œë¦¼                              â”‚
â”‚  â˜‘ í¬ì¸íŠ¸ ì ë¦½ ì•Œë¦¼                            â”‚
â”‚  â˜ ë§ˆì¼€íŒ… ì•Œë¦¼                                 â”‚
â”‚  ì•Œë¦¼ ì‹œê°„: 09:00 ~ 21:00                      â”‚
â”‚                                   [Complete]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Onboarding Complete!               â”‚
â”‚        "í™˜ì˜í•©ë‹ˆë‹¤, {ì‚¬ìš©ìëª…}ë‹˜!"              â”‚
â”‚          [Go to Dashboard]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Models

```typescript
// Enhanced User Entity
@Entity('users')
export class User {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  @Column({ unique: true })
  email: string;

  @Column({ nullable: true })
  password: string;

  @Column({ type: 'enum', enum: UserRole, default: UserRole.USER })
  role: UserRole;

  // Profile Information
  @Column({ nullable: true })
  name: string;

  @Column({ type: 'date', nullable: true })
  birthdate: Date;

  @Column({ type: 'enum', enum: Gender, nullable: true })
  gender: Gender;

  // Onboarding Status
  @Column({ default: false })
  isOnboardingComplete: boolean;

  @Column({ default: false })
  isEmailVerified: boolean;

  @Column({ default: true })
  isActive: boolean;

  // Social Login IDs
  @Column({ nullable: true })
  kakaoId: string;

  @Column({ nullable: true })
  naverId: string;

  @Column({ nullable: true })
  googleId: string;

  // Notification Settings
  @Column({ type: 'json', nullable: true })
  notificationSettings: {
    newFlyers: boolean;
    pointsEarned: boolean;
    marketing: boolean;
    quietHoursStart: string; // "09:00"
    quietHoursEnd: string; // "21:00"
  };

  // Relations
  @OneToMany(() => UserInterest, interest => interest.user)
  interests: UserInterest[];

  @OneToMany(() => UserAgreement, agreement => agreement.user)
  agreements: UserAgreement[];

  @CreateDateColumn()
  createdAt: Date;

  @UpdateDateColumn()
  updatedAt: Date;
}

enum Gender {
  MALE = 'male',
  FEMALE = 'female',
  OTHER = 'other',
  PREFER_NOT_TO_SAY = 'prefer_not_to_say',
}

// User Interest Entity
@Entity('user_interests')
export class UserInterest {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  @ManyToOne(() => User, user => user.interests)
  user: User;

  @Column()
  userId: string;

  @Column({ type: 'enum', enum: InterestCategory })
  category: InterestCategory;

  @CreateDateColumn()
  createdAt: Date;
}

enum InterestCategory {
  FOOD_DINING = 'food_dining',
  SHOPPING = 'shopping',
  HEALTH_BEAUTY = 'health_beauty',
  EDUCATION = 'education',
  SERVICES = 'services',
  LEISURE_CULTURE = 'leisure_culture',
  HOUSEHOLD = 'household',
  OTHER = 'other',
}

// User Agreement Entity
@Entity('user_agreements')
export class UserAgreement {
  @PrimaryGeneratedColumn('uuid')
  id: string;

  @ManyToOne(() => User, user => user.agreements)
  user: User;

  @Column()
  userId: string;

  @Column({ type: 'enum', enum: AgreementType })
  type: AgreementType;

  @Column()
  agreed: boolean;

  @Column({ type: 'timestamp' })
  agreedAt: Date;

  @Column({ nullable: true })
  version: string; // e.g., "v1.0"
}

enum AgreementType {
  TERMS_OF_SERVICE = 'terms_of_service',
  PRIVACY_POLICY = 'privacy_policy',
  LOCATION_TERMS = 'location_terms',
  MARKETING = 'marketing',
}
```

### API Endpoints

| Method | Endpoint | Description | Auth | Body |
|--------|----------|-------------|------|------|
| POST | /auth/register | Email/password registration | Public | `{ email, password, role: 'user' }` |
| POST | /auth/social/:provider | Social login (kakao/naver/google) | Public | OAuth callback |
| GET | /users/me | Get current user profile | JWT | - |
| PATCH | /users/me | Update user profile | JWT | `{ name?, birthdate?, gender? }` |
| POST | /users/:id/interests | Set user interests | JWT | `{ categories: string[] }` |
| PATCH | /users/:id/notifications | Update notification settings | JWT | `{ newFlyers, pointsEarned, marketing, quietHours }` |
| POST | /users/:id/agreements | Record user agreements | JWT | `{ agreements: [{ type, agreed }] }` |
| PATCH | /users/:id/complete-onboarding | Mark onboarding as complete | JWT | - |
| DELETE | /users/me | Delete account (soft delete) | JWT | - |

## Dependencies

### Prerequisites
- âœ… CORE-001 (Authentication & Authorization)
- âœ… Email service configured

### External Libraries
- `class-validator` (Form validation)
- `date-fns` (Date handling)

## Testing Strategy

### Unit Tests
- [ ] Form validation logic
- [ ] Interest category selection
- [ ] Notification settings update

### Integration Tests
- [ ] Complete onboarding flow
- [ ] Social login onboarding
- [ ] Profile update

### E2E Tests
- [ ] New user registration â†’ onboarding â†’ dashboard
- [ ] Social login â†’ onboarding â†’ dashboard
- [ ] Skip onboarding steps
- [ ] Profile editing

## Deployment Checklist

- [ ] Terms & conditions content finalized
- [ ] Privacy policy finalized
- [ ] Email templates created
- [ ] Social OAuth configured
- [ ] Database migrations
- [ ] Frontend assets (images)
- [ ] Analytics tracking
- [ ] Documentation

## Risks & Mitigation

| Risk | Impact | Probability | Mitigation |
|------|--------|-------------|------------|
| ì˜¨ë³´ë”© ì´íƒˆë¥  ë†’ìŒ | High | High | Skip ë²„íŠ¼, ë‹¨ê³„ ìµœì†Œí™” |
| ì†Œì…œ ë¡œê·¸ì¸ ì‹¤íŒ¨ | Medium | Low | Email login fallback |
| ì•½ê´€ ë™ì˜ ê±°ë¶€ | High | Medium | ëª…í™•í•œ ì„¤ëª…, í•„ìˆ˜/ì„ íƒ êµ¬ë¶„ |
| í”„ë¡œí•„ ì •ë³´ ëˆ„ë½ | Low | High | ì„ íƒ í•­ëª© ì²˜ë¦¬, ë‚˜ì¤‘ì— ìˆ˜ì • ê°€ëŠ¥ |

## Related Epics

- **Depends on**: CORE-001 (Authentication)
- **Blocks**: USR-002 (3-Hub Location Setup)
- **Related**: USR-007 (Digital Flyer Viewer)

## Notes

- ì˜¨ë³´ë”© ë‹¨ê³„ëŠ” ìµœì†Œí™”í•˜ì—¬ ì´íƒˆë¥  ë°©ì§€
- ëª¨ë“  ê°œì¸ì •ë³´ ì…ë ¥ì€ ì„ íƒ ì‚¬í•­ (Skip ê°€ëŠ¥)
- ì†Œì…œ ë¡œê·¸ì¸ ì‹œ ìë™ í”„ë¡œí•„ ì •ë³´ í™œìš©
- ì˜¨ë³´ë”© ë¯¸ì™„ë£Œ ì‚¬ìš©ìë„ ê¸°ë³¸ ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥
- ì¶”í›„ í”„ë¡œí•„ ì™„ì„±ë„ì— ë”°ë¥¸ ì¸ì„¼í‹°ë¸Œ ì œê³µ ê³ ë ¤

## Changelog

- **2025-12-24**: Epic created
  - User Onboarding & Registration planned
  - 8 user stories defined (22 story points)
  - 5-step onboarding flow designed
  - Privacy-first optional profile system
